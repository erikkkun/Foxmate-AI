# 打包测试指南

## 打包步骤

1. **运行打包脚本**：
   ```bash
   build_package.bat
   ```
   或者手动运行：
   ```bash
   pyinstaller "FoxMate AI.spec"
   ```

2. **检查输出**：
   - 打包文件位于 `dist/FoxMate AI/` 目录
   - 应该包含 `FoxMate AI.exe` 和 `_internal/` 文件夹

## 测试清单

### 基本功能测试

- [ ] **启动测试**：双击 `FoxMate AI.exe`，应该能看到前端主页
- [ ] **界面显示**：检查主页是否正常显示，包括：
  - 菜单按钮（≡）
  - Sign In 按钮
  - 设置按钮（⚙）
  - 关闭按钮（✕）
  - "Fox it!" 按钮
- [ ] **导航测试**：点击菜单按钮，检查抽屉菜单是否正常显示
- [ ] **页面切换**：测试各个页面是否可以正常切换

### 资源文件测试

- [ ] **图片资源**：检查狐狸图片是否正常显示（如果存在）
- [ ] **图标资源**：检查应用图标是否正常（如果存在）
- [ ] **声音文件**：测试后端启动时声音文件是否可以正常访问

### 后端功能测试

- [ ] **启动后端**：点击 "Fox it!" 按钮，检查后端是否可以正常启动
- [ ] **狐狸宠物**：检查桌面宠物是否正常显示
- [ ] **专注度监控**：检查专注度分数是否正常更新

### 路径测试

- [ ] **相对路径**：将整个 `FoxMate AI` 文件夹移动到其他位置，测试是否仍能正常运行
- [ ] **资源访问**：检查所有资源文件（图片、模型、声音）是否可以正常访问

## 常见问题排查

### 问题1：exe无法启动
- **检查**：查看是否有错误提示
- **解决**：尝试在命令行运行exe查看错误信息
- **调试**：临时将 `console=False` 改为 `console=True` 查看错误

### 问题2：缺少模块错误
- **检查**：查看错误信息中缺少的模块
- **解决**：在 `.spec` 文件的 `hiddenimports` 中添加缺失的模块

### 问题3：资源文件找不到
- **检查**：确认资源文件已正确添加到 `datas` 列表
- **解决**：检查代码中的路径引用是否正确使用了 `sys._MEIPASS`

### 问题4：前端主页不显示
- **检查**：确认 `frontend/pages` 目录已正确打包
- **检查**：确认 `frontend/routes.py` 已正确打包
- **解决**：检查路径引用是否正确

## 打包优化建议

1. **文件大小**：如果打包文件过大，可以考虑：
   - 排除不必要的测试文件
   - 使用 `--exclude-module` 排除未使用的模块
   - 考虑使用 `--onefile` 模式（但启动会较慢）

2. **启动速度**：如果启动较慢：
   - 这是正常的，因为需要解压资源文件
   - 可以考虑使用文件夹模式（当前模式）

3. **代码签名**：生产环境建议添加代码签名证书

## 分发准备

打包测试通过后：

1. **压缩文件**：
   - 将 `dist/FoxMate AI/` 文件夹压缩为ZIP
   - 添加 `README.txt` 到ZIP根目录

2. **文件结构**：
   ```
   FoxMate AI v1.0.zip
   ├── FoxMate AI/
   │   ├── FoxMate AI.exe
   │   └── _internal/
   └── README.txt
   ```

3. **上传分发**：
   - 上传到GitHub Releases
   - 或上传到云存储服务
   - 提供下载链接
